---
layout: post
title: 定时器
date: 2020-06-05
Author: xuxeu
categories: 
tags: [time]
comments: true
typora-root-url: ..
---

> 定时器，是指从指定的时刻开始，经过一定的指定时间后触发一个事件，例如定个时间提醒第二天能够按时起床。

定时器有硬件定时器和软件定时器之分：

1. 硬件定时器是芯片本身提供的定时功能。一般是由外部晶振提供给芯片输入时钟，芯片向软件模块提供一组**配置**寄存器，接受控制输入，到达设定时间值后芯片中断控制器产生时钟中断。硬件定时器的精度一般很高，可以达到纳秒级别，并且是**中断触发**方式。
2. 软件定时器是由操作系统提供的一类系统接口，它**构建在硬件定时器基础之上**，使系统能够提供**不受数目限制**的定时器服务。

RT-Thread 操作系统提供软件实现的定时器，以时钟节拍（OS Tick）的时间长度为单位，即**定时数值必须是 OS Tick 的整数倍**，例如一个 OS Tick 是 10ms，那么上层软件定时器只能是 10ms，20ms，100ms等，而不能定时为 15ms。

**RT-Thread 的定时器也基于系统的节拍**，提供了基于节拍整数倍的定时能力。

在 RT-Thread 定时器模块中维护着两个重要的全局变量：

1. 当前系统经过的 tick 时间 rt_tick（当硬件定时器中断来临时，它将加 1）；
2. 定时器链表 rt_timer_list。系统新创建并激活的定时器都会按照以超时时间排序的方式插入到rt_timer_list 链表中。

#### 出差必备

买火车票、高铁票、机票，订酒店都打9折的出行工具TRIP,[点击注册](https://h5.itrip.world/#/register/6tpd1Z)

